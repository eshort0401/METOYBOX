

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Anelastic Equations &mdash; metoybox 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
      <link rel="stylesheet" type="text/css" href="../_static/assets/css/base.css?v=5c8c2ed0" />
      <link rel="stylesheet" type="text/css" href="../_static/assets/css/controls.css?v=5ffa823a" />
      <link rel="stylesheet" type="text/css" href="https://pyscript.net/releases/2024.1.1/core.css" />

  
    <link rel="canonical" href="https://eshort0401.github.io/METOYBOX/foundations/anelastic_boussinesq.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"tex": {"tags": "ams", "useLabelIds": true}, "chtml": {"displayAlign": "center"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
      <script src="../_static/assets/js/model-controls.js?v=07a4f401"></script>
      <script src="../_static/assets/js/scale-table.js?v=05822f22"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Anelastic Vorticity Equation" href="anelastic_vorticity_equation.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            metoybox
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Foundations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The Anelastic Equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#derivation-of-anelastic-system">Derivation of Anelastic System</a></li>
<li class="toctree-l3"><a class="reference internal" href="#derivation-of-boussinesq-system">Derivation of Boussinesq System</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extensions">Extensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="anelastic_vorticity_equation.html">Anelastic Vorticity Equation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gravity_waves/index.html">Inertia-Gravity Waves</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">metoybox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Foundations</a></li>
      <li class="breadcrumb-item active">The Anelastic Equations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/foundations/anelastic_boussinesq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-anelastic-equations">
<h1>The Anelastic Equations<a class="headerlink" href="#the-anelastic-equations" title="Link to this heading"></a></h1>
<p>Loosely speaking, the anelastic approximation is obtained by</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>defining a base state, and using this to express the governing equations in buoyancy form.</p></li>
<li><p>Replacing <span class="math notranslate nohighlight">\(\rho\)</span> with a horizontally uniform <span class="math notranslate nohighlight">\(\overline{\rho}(z)\)</span> wherever <span class="math notranslate nohighlight">\(\rho\)</span> appears explicitly in the momentum and continuity equations.</p></li>
</ol>
</div></blockquote>
<p>Our governing momentum and continuity equations become</p>
<div class="admonition-anelastic-equations admonition">
<p class="admonition-title">Anelastic Equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{D \mathbf{v}}{Dt} + f\mathbf{k}\times \mathbf{v} &amp;= -\nabla \left(\frac{p}{\overline{\rho}}\right) + g\delta \phi \mathbf{k}, &amp; \\
\nabla \cdot \left(\overline{\rho} \mathbf{v}\right) &amp;= 0 &amp;
\end{align}\end{split}\]</div>
</div>
<p>The Boussinesq equations are very similar, but we instead replace <span class="math notranslate nohighlight">\(\rho\)</span> with a constant <span class="math notranslate nohighlight">\(\rho_s\)</span> in the momentum and continuity equations (but nowhere else!)</p>
<p>I initially found both these approximations very unpleasant. Seeing variables substituted out in some places but not others felt dirty. <a class="reference external" href="https://doi.org/10.1175/1520-0469(1962)019&lt;0173:SAODAS&gt;2.0.CO;2">Ogura and Phillips (1962)</a> provided the remedy, with a clean derivation based on truncations of asymptotic expansions. However, <a class="reference external" href="https://doi.org/10.1175/1520-0469(1962)019&lt;0173:SAODAS&gt;2.0.CO;2">Ogura and Phillips (1962)</a> use the <a class="reference external" href="https://en.wikipedia.org/wiki/Exner_function">Exner function</a> in place of pressure, which produces a more numerically accurate system, but obfuscates physical interpretation. Instead, I provide a derivation using vanilla variables, partly plagiarized from <a class="reference external" href="https://doi.org/10.1017/9781107588417">Vallis (2017, p. 75)</a>.</p>
<section id="derivation-of-anelastic-system">
<span id="derivation"></span><h2>Derivation of Anelastic System<a class="headerlink" href="#derivation-of-anelastic-system" title="Link to this heading"></a></h2>
<p>Our approach here will be to expand key terms as Taylor series, but instead of immediately truncating, we will carry all the residual terms through to the bitter end, eventually performing a scale analysis to justify their final dismissal. To begin, we decompose our thermodynamic variables into hydrostatic and perturbation components. Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
p &amp;= \overline{p}(z) + \delta p(x,y,z,t), \\
\rho &amp;= \overline{\rho}(z) + \delta \rho(x,y,z,t), \\
T &amp;= \overline{T}(z) + \delta T(x,y,z,t),
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{p}\)</span>, <span class="math notranslate nohighlight">\(\overline{\rho}\)</span>, and <span class="math notranslate nohighlight">\(\overline{T}\)</span> denote hydrostatic base state terms, assumed to be functions of <span class="math notranslate nohighlight">\(z\)</span> only, with <span class="math notranslate nohighlight">\(\delta p\)</span>, <span class="math notranslate nohighlight">\(\delta \rho\)</span>, and <span class="math notranslate nohighlight">\(\delta T\)</span> the corresponding perturbations. Now define <span class="math notranslate nohighlight">\(\theta = \overline{\theta}(z) + \delta\theta,\)</span> where</p>
<div class="math notranslate nohighlight">
\[\theta = T\left(\frac{p_s}{p}\right)^{\frac{R}{c_p}}, \quad \overline{\theta} = \overline{T}\left(\frac{p_s}{\overline{p}}\right)^{\frac{R}{c_p}},\]</div>
<p>with <span class="math notranslate nohighlight">\(p_s\)</span> a constant reference pressure used to ensure dimensional consistency. Next, form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\overline{\phi} &amp;= \ln\left(\frac{\overline{\theta}}{\theta_s}\right) = \frac{1}{\gamma}\ln\left(\frac{\overline{p}}{p_s}\right)  - \ln\left(\frac{\overline{\rho}}{\rho_s}\right), &amp;\\
\phi &amp;= \ln\left(\frac{\theta}{\theta_s}\right) = \frac{1}{\gamma}\ln\left(\frac{\overline{p}+\delta p}{p_s}\right)  - \ln\left(\frac{\overline{\rho} + \delta \rho}{\rho_s}\right), &amp;
\end{align}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\gamma = \frac{c_v}{c_p}\)</span> and <span class="math notranslate nohighlight">\(\theta_s\)</span> and <span class="math notranslate nohighlight">\(\rho_s\)</span> constant reference values. Now, assume <span class="math notranslate nohighlight">\(\delta p &lt; \overline{p}\)</span>, and <span class="math notranslate nohighlight">\(\delta \rho &lt; \overline{\rho}\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\delta \phi = \phi - \overline{\phi} &amp;=  \frac{1}{\gamma}\ln\left(\frac{\overline{p} + \delta p}{\overline{p}}\right)  - \ln\left(\frac{\overline{\rho}+\delta \rho}{\overline{\rho}}\right) &amp; \nonumber \\
&amp;=  \frac{1}{\gamma}\frac{\delta p}{\overline{p}} + R_1 - \frac{\delta \rho}{\overline{\rho}}  + R_2 \label{eq:delphi} &amp;
\end{align}\end{split}\]</div>
<p>by <a class="reference external" href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">Taylor’s theorem</a>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
R_1 &amp;= \frac{1}{\gamma}\left[-\frac{1}{2}\left(\frac{\delta p}{\overline{p}}\right)^2 + \frac{1}{3}\left(\frac{\delta p}{\overline{p}}\right)^3 + \cdots \right] \\
R_2 &amp;= -\frac{1}{2}\left(\frac{\delta \rho}{\overline{\rho}}\right)^2 + \frac{1}{3}\left(\frac{\delta \rho}{\overline{\rho}}\right)^3 + \cdots.
\end{align*}\end{split}\]</div>
<p>Note, these sums only converge if <span class="math notranslate nohighlight">\(\frac{\delta p}{\overline{p}} &lt; 1\)</span> and <span class="math notranslate nohighlight">\(\frac{\delta \rho}{\overline{\rho}} &lt; 1\)</span>, hence our assumption above.</p>
<p>Note also that</p>
<div class="math notranslate nohighlight">
\[g\delta \phi = g\ln\left(\frac{\overline{\theta} + \delta \theta}{\overline{\theta}}\right) = g\frac{\delta \theta}{\overline{\theta}} + O\left(\left[\frac{\delta \theta}{\overline{\theta}}\right]^2\right)\]</div>
<p>is buoyancy <span class="math notranslate nohighlight">\(b\)</span> in the anelastic system. Furthermore,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial \overline{\phi}}{\partial z} &amp;= \frac{1}{\gamma \overline{p}}\frac{\partial \overline{p}}{\partial z} - \frac{1}{ \overline{\rho}}\frac{\partial \overline{\rho}}{\partial z} &amp;\nonumber \\
&amp;= -\frac{g \overline{\rho}}{\gamma \overline{p}} - \frac{1}{ \overline{\rho}}\frac{\partial \overline{\rho}}{\partial z} \label{eq:bar_phi_z} &amp;
\end{align}\end{split}\]</div>
<p>as the base state is hydrostatic.</p>
<p>Turning now to our governing equations, the inviscid horizontal momentum equation is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \frac{D\mathbf{u}}{Dt} + f\mathbf{k}\times \mathbf{u} &amp;= -\frac{1}{\overline{\rho}+\delta \rho}\nabla_h \delta p, &amp; \nonumber \\
&amp;= -\frac{1}{\overline{\rho}} \nabla_h \delta p + R_3 \nabla_h \delta p, &amp; \label{eq:anumom}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h = \left(\frac{\partial }{\partial x}, \frac{\partial }{\partial y} \right)\)</span> is the horizontal gradient operator, <span class="math notranslate nohighlight">\(\mathbf{u}=(u,v)\)</span> is the horizontal velocity, and</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
R_3 = O\left(\frac{\delta \rho}{\overline{\rho}^2}\right),
\end{equation}\]</div>
<p>exploiting Taylor’s theorem once again.</p>
<p>The vertical momentum equation implies</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    (\overline{\rho} + \delta \rho)\frac{D w}{Dt} &amp;= -\frac{\partial \left(\overline{p} + \delta p \right)}{\partial z} - g\left( \overline{\rho} + \delta\rho \right) &amp; \nonumber \\
&amp;= -\frac{\partial \delta p}{\partial z} - g\delta \rho, &amp;
\end{align}\end{split}\]</div>
<p>where the second line follows from the hydrostasy of the base state. Dividing through by <span class="math notranslate nohighlight">\(\overline{\rho} + \delta \rho\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \frac{D w}{Dt} &amp;= -\frac{1}{\overline{\rho}}\frac{\partial \delta p}{\partial z} - g\frac{\delta \rho}{\overline{\rho}} + R_3\left(-\frac{\partial \delta p}{\partial z} - g\delta\rho \right) \\
&amp;=-\frac{\partial}{\partial z}\left(\frac{\delta p}{\overline{\rho}}\right) - \frac{\delta p}{\overline{\rho}^2}\frac{\partial \overline{\rho}}{\partial z} - g\frac{\delta \rho}{\overline{\rho}} + R_3\left(-\frac{\partial \delta p}{\partial z} - g\delta\rho \right).
\end{align}\end{split}\]</div>
<p>Substituting for <span class="math notranslate nohighlight">\(-g\frac{\delta \rho}{\overline{\rho}}\)</span> using <span class="math notranslate nohighlight">\(g\times \eqref{eq:delphi}\)</span> results in</p>
<div class="math notranslate nohighlight">
\[\frac{D w}{Dt} = -\frac{\partial}{\partial z}\left(\frac{\delta p}{\overline{\rho}}\right) - \frac{\delta p}{\overline{\rho}^2}\frac{\partial \overline{\rho}}{\partial z} + g\delta \phi - \frac{g}{\gamma}\frac{\delta p}{\overline{p}} + R_4,\]</div>
<p>where we have collected all the residual terms into</p>
<div class="math notranslate nohighlight">
\[R_4 = -gR_1 - gR_2 + R_3\left(-\frac{\partial \delta p}{\partial z} - g\delta\rho \right)\]</div>
<p>just to keep things tidy.</p>
<p>Substituting the second and fourth terms using <span class="math notranslate nohighlight">\(\frac{\delta p}{\overline{\rho}}\times\eqref{eq:bar_phi_z}\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
    \frac{D w}{Dt} =  g\delta \phi -\frac{\partial}{\partial z}\left(\frac{\delta p}{\overline{\rho}}\right) +\frac{\delta p}{\overline{\rho}}\frac{\partial \overline{\phi}}{\partial z} + R_4. \label{eq:w_t_intermediate}
\end{equation}\]</div>
<p>Now, suppose we also require that the base state is neutrally stratified, i.e. that <span class="math notranslate nohighlight">\(\overline{\theta}\)</span>, and therefore <span class="math notranslate nohighlight">\(\overline{\phi}\)</span>, are constant. Then <span class="math notranslate nohighlight">\(\eqref{eq:w_t_intermediate}\)</span> reduces to</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
    \frac{D w}{Dt} =  g\delta \phi -\frac{\partial}{\partial z}\left(\frac{\delta p}{\overline{\rho}}\right) + R_4. \label{eq:anwmom}
\end{equation}\]</div>
<p>Finally, recall mass conservation is given by</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
    \frac{\partial \delta \rho}{\partial t} + \nabla \cdot \left[\left(\overline{\rho} + \delta \rho\right)\mathbf{v}\right] = 0.
\end{equation}\]</div>
<p>which we re-express as</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
    \nabla \cdot \left(\overline{\rho} \mathbf{v}\right) = - \nabla \cdot \left(\delta \rho \mathbf{v}\right)-\frac{\partial \delta \rho}{\partial t} \label{eq:anmass}.
\end{equation}\]</div>
<p>So the anelastic approximation will be reasonable provided we can discard the terms on the right-hand-side of <span class="math notranslate nohighlight">\(\eqref{eq:anmass}\)</span>, and the residual terms in <span class="math notranslate nohighlight">\(\eqref{eq:anumom}\)</span> and <span class="math notranslate nohighlight">\(\eqref{eq:anwmom}\)</span>. To explore circumstances where discarding these terms is defensible, we perform a scale analysis. This means we specify the length, height and time scales <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(H\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> of the processes we care about, and use these to infer representative scales for <span class="math notranslate nohighlight">\(U\)</span>, <span class="math notranslate nohighlight">\(W\)</span>. We can then check which terms in our governing equations are important at these scales.</p>
<div id="anelastic">
    <div id="loading-screen">
        <div class="spinner"></div>
        <p>Loading...</p>
        <p><small>This can take a few minutes!</small></p>
    </div>
    <div id="main-content">
        <div id="scale-table"></div>
        <div id="controls"></div>
        <script>
            (function(containerID) {
                // Setup constants
                const c_p = 1005; // J kg^-1 K^-1
                const c_v = 718; // J kg^-1 K^-1
                const gamma = c_p / c_v;
                const R = c_p - c_v; // J kg^-1 K^-1
                const g = 9.81; // m s^-2
                const Omega = (2 * Math.PI) / (24 * 3600); // rad s^-1
                const f = Omega;
                
                // Define reference values
                const p_s = 1e5; // Pa
                const T_s = 300; // K
                const rho_s = p_s / (R * T_s); // Ideal gas law
                
                /**
                 * Calculate the terms for the scale analysis table
                 * @param {number} L - Horizontal length scale
                 * @param {number} U - Horizontal velocity scale
                 * @param {number} W - Vertical velocity scale
                 * @param {number} P_bar - Base state pressure scale
                 * @param {number} R_bar - Base state density scale
                 * @returns {number[]} - Array with inferred scales
                 */
                function inferredScales(L, U, W, P_bar, R_bar) {
                    const T = L / U;
                    const H = W * T;
                
                    // Infer Del_P from horizontal momentum equation
                    const Del_P = Math.max(R_bar * U ** 2, R_bar * f * U * L);
                
                    // Infer Del_R from vertical momentum equation
                    const Del_R = Math.max((W ** 2 * R_bar) / (g * H), Del_P / (g * H));
                
                    if (Del_P > P_bar || Del_R > R_bar) {
                        return [null, null, null, null, null];
                    }
                
                    // Buoyancy Scale
                    const Del_Phi =
                        (1 / gamma) * Math.log((P_bar + Del_P) / P_bar) -
                        Math.log((R_bar + Del_R) / R_bar);
                
                    return [T, H, Del_P, Del_R, Del_Phi];
                }
                
                /**
                 * Calculate the terms for the scale analysis table
                 * @param {number} L - Horizontal length scale
                 * @param {number} U - Horizontal velocity scale
                 * @param {number} W - Vertical velocity scale
                 * @param {number} P_bar - Base state pressure scale
                 * @param {number} R_bar - Base state density scale
                 * @returns {Array} - 2D array of table values
                 */
                function calculateTableValues(L, U, W, P_bar, R_bar) {
                    // Implied Scales
                    const [T, H, Del_P, Del_R, Del_Phi] = inferredScales(L, U, W, P_bar, R_bar);
                
                    if ([T, H, Del_P, Del_R, Del_Phi].some(x => x === null)) {
                        // Handle the null case
                        return [
                            [null, null, null, null],
                            [null, null, null, null],
                            [null, null, null, null],
                        ];
                    }
                
                    // Residuals
                    const Del_Phi_1 = (1 / gamma) * (Del_P / P_bar);
                    const Del_Phi_2 = -(Del_R / R_bar);
                    const R_1 = (1 / gamma) * Math.log((P_bar + Del_P) / P_bar) - Del_Phi_1;
                    const R_2 = -Math.log((R_bar + Del_R) / R_bar) - Del_Phi_2;
                    const R_3 = 1 / (R_bar + Del_R) - 1 / R_bar;
                    const R_4 = -g * R_1 - g * R_2 + R_3 * (-Del_P / H - g * Del_R);
                
                    const u_mom_terms = [
                        U / T,
                        f * U,
                        (1 / R_bar) * (Del_P / L),
                        (R_3 * Del_P) / L,
                    ];
                    const w_mom_terms = [W / T, g * Del_Phi, Del_P / R_bar / H, R_4];
                    const cont_terms = [Del_R / T, R_bar / T, R_bar / T, Del_R / T];
                
                    return [u_mom_terms, w_mom_terms, cont_terms];
                }
                
                // Create container for the table
                let tableIndentifer = `#${containerID} #main-content #scale-table`;
                const table_container = document.querySelector(tableIndentifer);
                
                // Create sliders to control scales. Note sliders are logarithmic, but values
                // stored in scaleTable are linear.
                
                args = [`${containerID}-P_bar-slider`, `${containerID}-P_bar-output`];
                // 1e5 Pa = 1000 hPa = 1 bar
                args.push("\\(\\overline{P}:\\)", 4, 6, 5);
                args.push(0.1, null, "Pa");
                const PBarSliderRow = createSliderRow(...args);
                
                args = [`${containerID}-R_bar-slider`, `${containerID}-R_bar-output`];
                args.push("\\(\\overline{R}:\\)", -3, 0.5, 0, 0.1);
                args.push(null, "kg m⁻³");
                const RBarSliderRow = createSliderRow(...args);
                
                args = [`${containerID}-U-slider`, `${containerID}-U-output`];
                args.push("\\(U:\\)", -3, 2, 1, 0.1);
                args.push(null, "m");
                const USliderRow = createSliderRow(...args);
                
                args = [`${containerID}-W-slider`, `${containerID}-W-output`];
                args.push("\\(W:\\)", -3, 2, 1, 0.1);
                args.push(null, "m");
                const WSliderRow = createSliderRow(...args);
                
                args = [`${containerID}-L-slider`, `${containerID}-L-output`];
                args.push("\\(L:\\)", -3, 6, 3, 0.1);
                args.push(null, "m");
                const LSliderRow = createSliderRow(...args);
                
                allSliders = [LSliderRow, USliderRow, WSliderRow, PBarSliderRow, RBarSliderRow];
                // Fix the initial slider outputs for exponential formatting
                initializeOutputs(allSliders);
                
                const initialSliderValues = allSliders.map(
                    (slider) => 10 ** slider.querySelector("input").value
                );
                
                // Now append all the slider rows to the controls container
                let controlsIdentifier = `#${containerID} #main-content #controls`;
                const controls = document.querySelector(controlsIdentifier);
                controls.append(...allSliders);
                
                // Build the scale table
                initialTableValues = calculateTableValues(...initialSliderValues);
                initialInferredScaleValues = inferredScales(...initialSliderValues);
                const zPressureGradientForce =
                    "-\\frac{\\partial }{\\partial z}" +
                    "\\left(\\frac{\\delta p}{\\overline{\\rho}}\\right)";
                const scaleTable = new ScaleTable(
                    containerID,
                    [
                        [
                            "\\frac{D \\mathbf{u}}{D t}",
                            "f\\mathbf{k}\\times \\mathbf{u}",
                            "-\\frac{1}{\\overline{\\rho}} \\nabla_h \\delta p",
                            "R_3 \\nabla_h \\delta p",
                        ],
                        ["\\frac{D w}{D t}", "g\\delta \\phi", zPressureGradientForce, "R_4"],
                        [
                            "\\frac{\\partial \\delta \\rho}{\\partial t}",
                            "\\nabla_h \\cdot (\\overline{\\rho} \\mathbf{u})",
                            "\\frac{\\partial }{\\partial z}(\\overline{\\rho} w)",
                            "\\nabla \\cdot (\\delta \\rho \\mathbf{v})",
                        ],
                    ],
                    initialTableValues,
                    [
                        ["m s<sup>-2</sup>"],
                        ["m s<sup>-2</sup>"],
                        ["kg m<sup>-3</sup> s<sup>-1</sup>"],
                    ],
                    ["T", "H", "\\Delta P", "\\Delta R", "\\Delta \\Phi"],
                    initialInferredScaleValues,
                    ["s", "m", "Pa", "kg m<sup>-3</sup>", ""]
                );
                table_container.append(scaleTable.table, scaleTable.inferredScalesDiv);
                
                // Setup the listeners
                let sliderIDs = [`${containerID}-L-slider`, `${containerID}-U-slider`];
                sliderIDs.push(`${containerID}-W-slider`);
                sliderIDs.push(`${containerID}-P_bar-slider`);
                sliderIDs.push(`${containerID}-R_bar-slider`);
                
                addListeners(sliderIDs, inferredScales, calculateTableValues, scaleTable);
                
                // Hide loading screen and show main content
                const container = document.querySelector(`#${containerID}`);
                const loading_screen = container.querySelector("#loading-screen");
                const main_content = container.querySelector("#main-content");
                
                loading_screen.style.display = "none";
                main_content.style.display = "block";
                
                container.classList.add("dimensional-mode");
            })('anelastic');
        </script>
    </div>
</div><p>Summarizing, we have</p>
<div class="admonition-anelastic-equations admonition">
<p class="admonition-title">Anelastic Equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{D \mathbf{v}}{Dt} + f\mathbf{k}\times \mathbf{v} &amp;= -\nabla \left(\frac{p}{\overline{\rho}}\right) + g\delta \phi \mathbf{k}, &amp; \\
\nabla \cdot \left(\overline{\rho} \mathbf{v}\right) &amp;= 0 &amp;
\end{align}\end{split}\]</div>
</div>
<p>The above derivation suggests the anelastic approximation will only be as accurate as the difference between the magnitudes of the pressure and density perturbations and the corresponding base state values, given that the base state is also neutrally stratified.</p>
</section>
<section id="derivation-of-boussinesq-system">
<h2>Derivation of Boussinesq System<a class="headerlink" href="#derivation-of-boussinesq-system" title="Link to this heading"></a></h2>
<p>The derivation of the Boussinesq equations mostly follows the same steps as above; we still define a hydrostatic, neutrally stratified base state and the buoyancy variable <span class="math notranslate nohighlight">\(\delta \phi\)</span>. The simplification of <span class="math notranslate nohighlight">\(\delta \phi\)</span> given by <span class="math notranslate nohighlight">\(\eqref{eq:delphi}\)</span> will be just as accurate as in the anelastic case.</p>
<p>The difference with the Boussinesq system is we approximate <span class="math notranslate nohighlight">\(\overline{\rho}+\delta \rho\)</span> by a constant reference density <span class="math notranslate nohighlight">\(\rho_s\)</span> on the left hand sides in equations <span class="math notranslate nohighlight">\(\eqref{eq:anumom}\)</span>, <span class="math notranslate nohighlight">\(\eqref{eq:anwmom}\)</span>, and <span class="math notranslate nohighlight">\(\eqref{eq:anmass}\)</span> (but nowhere else!) The Boussinesq system will thus only be numerically accurate when the overall density field <span class="math notranslate nohighlight">\(\rho\)</span> is close to <span class="math notranslate nohighlight">\(\rho_s\)</span> everywhere, which typically only occurs when the vertical scale being considered is much smaller than the density scale height (about 8 km in Earth’s lower atmosphere.)</p>
</section>
<section id="extensions">
<h2>Extensions<a class="headerlink" href="#extensions" title="Link to this heading"></a></h2>
<p>Elaborating is on my todo list, but in brief, note both the anelastic and Boussinesq systems can be made more numerically accurate by using the Exner function; see <a class="reference external" href="https://doi.org/10.1175/1520-0469(1962)019&lt;0173:SAODAS&gt;2.0.CO;2">Ogura and Phillips (1962)</a>. <a class="reference external" href="https://doi.org/10.1175/1520-0469(1989)046&lt;1453:ITAA&gt;2.0.CO;2">Durran (1989)</a> has also grappled with the anelastic system, seeking to remove the requirement of a neutrally stratified base state.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="anelastic_vorticity_equation.html" class="btn btn-neutral float-right" title="Anelastic Vorticity Equation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Ewan Short.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>