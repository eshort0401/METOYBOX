<div id="plane_wave">
    <div id="loading-screen">
        <div class="spinner"></div>
        <p>Loading...</p>
        <p><small>This can take a few minutes!</small></p>
    </div>
    <div id="main-content">
        <div id="figure-output">
            <!-- Use two layers to prevent flickering in firefox -->
            <div id="plane_wave-figure-output-A" class="figure-layer is-active"></div>
            <div id="plane_wave-figure-output-B" class="figure-layer is-passive"></div>
        </div>
        <div id="controls"></div>
        <script>
            (function(containerID) {
                // Note containerID is set by utils.py
                
                const dimSliders = coreWaveSlidersDim(containerID);
                delete dimSliders.Q0Slider;
                const nonDimSliders = coreWaveSlidersNonDim(containerID);
                
                // Allow alpha to be zero for these models (also initialize to zero)
                nonDimSliders.alphaOmegaSlider.querySelector('input').min = 0;
                dimSliders.alphaSlider.querySelector('input').min = 0;
                nonDimSliders.alphaOmegaSlider.querySelector('input').value = 0;
                dimSliders.alphaSlider.querySelector('input').value = 0;
                
                const kMin = 0.1;
                const kMax = 10 * Math.PI;
                const kStep = (kMax - kMin) * stepRatio;
                const kValue = Math.PI; // Set starting horizontal wavelength to 2 non-dimensional unit
                
                nonDimSliders.kSlider = createSliderRow(
                    `${containerID}-k-slider`,
                    `${containerID}-k-output`,
                    "\\(k:\\)",
                    kStep,
                    kMax,
                    kValue,
                    kStep,
                    "non-dimensional"
                );
                
                const scale = Omega / (NValue * HValue);
                const kMinDim = kMin * scale;
                const kMaxDim = kMax * scale;
                const kStepDim = kStep * scale;
                
                dimSliders.kDimSlider = createSliderRow(
                    `${containerID}-k_dim-slider`,
                    `${containerID}-k_dim-output`,
                    "\\(k:\\)",
                    kStepDim,
                    kMaxDim,
                    kValue * scale,
                    kStepDim,
                    "dimensional",
                    "m⁻¹"
                );
                
                const sigmaMin = 0.1;
                const sigmaMax = 5;
                const sigmaStep = (sigmaMax - sigmaMin) * stepRatio;
                
                nonDimSliders.sigmaSlider = createSliderRow(
                    `${containerID}-sigma-slider`,
                    `${containerID}-sigma-output`,
                    "\\(\\sigma:\\)",
                    sigmaMin,
                    sigmaMax,
                    1,
                    sigmaStep,
                    "non-dimensional"
                );
                
                const sigmaMinDim = sigmaMin * Omega;
                const sigmaMaxDim = sigmaMax * Omega;
                const sigmaStepDim = sigmaStep * Omega;
                
                dimSliders.sigmaDimSlider = createSliderRow(
                    `${containerID}-sigma_dim-slider`,
                    `${containerID}-sigma_dim-output`,
                    "\\(\\sigma:\\)",
                    sigmaStepDim,
                    sigmaMaxDim,
                    Omega,
                    sigmaStepDim,
                    "dimensional",
                    "s⁻¹"
                );
                
                const coordinateToggle = createCoordinateSelectionRow(containerID);
                const overlayToggle = createOverlayToggleRow(containerID);
                const imshowSelection = createImshowSelectionRow(
                    containerID,
                    ["psi", "u", "v", "w", "phi"],
                    ["\\(\\psi\\)", "\\(u\\)", "\\(v\\)", "\\(w\\)", "\\(\\phi\\)"]
                );
                
                // Get the relevant div container
                container = document.querySelector(`#${containerID} #main-content #controls`);
                // Append all the control rows to the container
                container.append(coordinateToggle, overlayToggle, imshowSelection);
                container.append(...Object.values(nonDimSliders), ...Object.values(dimSliders));
                setupCoordinateToggle(containerID);
            })('plane_wave');
        </script>
        <py-script 
            src="/METOYBOX/_static/models/gravity_waves/plane_wave/plane_wave.py" 
            config="/METOYBOX/_static/assets/pyscript.toml"
            data-container-id="plane_wave">
        </py-script>
    </div>
</div>