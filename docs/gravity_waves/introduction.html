

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; metoybox 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
      <link rel="stylesheet" type="text/css" href="../_static/assets/css/base.css?v=3a193a7f" />
      <link rel="stylesheet" type="text/css" href="../_static/assets/css/controls.css?v=48e535e7" />
      <link rel="stylesheet" type="text/css" href="https://pyscript.net/releases/2024.1.1/core.css" />

  
    <link rel="canonical" href="https://eshort0401.github.io/METOYBOX/gravity_waves/introduction.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"tex": {"tags": "ams", "useLabelIds": true}, "chtml": {"displayAlign": "center"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
      <script src="../_static/assets/js/model-controls.js?v=bbc0d3a8"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Land-Sea Breeze" href="land_sea.html" />
    <link rel="prev" title="Inertia-Gravity Waves" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            metoybox
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../foundations/index.html">Foundations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Inertia-Gravity Waves</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#governing-equations">Governing equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-dimensionalization">Non-Dimensionalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hydrostatic-waves">Hydrostatic Waves</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-stream-function">The Stream Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-partial-differential-equation">A Partial Differential Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-fourier-transform">The Fourier Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solution">Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#appendix-a-operators">Appendix A: Operators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="land_sea.html">Land-Sea Breeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="gaussian_forcing.html">Gaussian Temporal Forcing</a></li>
<li class="toctree-l2"><a class="reference internal" href="localized_line_forcing.html">Localized Line Forcing</a></li>
<li class="toctree-l2"><a class="reference internal" href="slope_breeze.html">Slope Breeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="point_forcing_over_slope.html">Point Forcing Over Slope</a></li>
<li class="toctree-l2"><a class="reference internal" href="plane_wave.html">Plane Wave</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">metoybox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Inertia-Gravity Waves</a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gravity_waves/introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p>Here we present models that feature inertia-gravity wave dynamics. Most of our models are derived from the work of <a class="reference external" href="https://doi.org/10.1175/1520-0469(1983)040&lt;1999:OTLTOT&gt;2.0.CO;2">Rotunno (1983)</a>. We can often solve these models purely analytically, sometimes discovering interesting connections between the maths, logic and physics. On this page, we use the original <a class="reference external" href="https://doi.org/10.1175/1520-0469(1983)040&lt;1999:OTLTOT&gt;2.0.CO;2">Rotunno (1983)</a> model to introduce some key ideas; further details on the <a class="reference external" href="https://doi.org/10.1175/1520-0469(1983)040&lt;1999:OTLTOT&gt;2.0.CO;2">Rotunno (1983)</a> model itself can be found on the <a class="reference internal" href="land_sea.html"><span class="doc">Land-Sea Breeze</span></a> page.</p>
<section id="governing-equations">
<h2>Governing equations<a class="headerlink" href="#governing-equations" title="Link to this heading"></a></h2>
<p>We first linearize the governing equations and make the <a class="reference external" href="https://doi.org/10.1175/1520-0469(1962)019&lt;0173:SAODAS&gt;2.0.CO;2">Boussinesq/shallow-anelastic</a> and <span class="math notranslate nohighlight">\(f\)</span>-plane approximations. The symbol <span class="math notranslate nohighlight">\(*\)</span> indicates our variables our “dimensional”, i.e. they have physical units; we discuss the corresponding unit-less “non-dimensional” later.</p>
<div class="admonition-dimensional-governing-equations admonition">
<p class="admonition-title">Dimensional Governing Equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial u_*}{\partial t_*} &amp;= fv_* - \frac{\partial \phi_*}{\partial x_*} - \alpha u_*, \label{u_mom_dim} \\
\frac{\partial v_*}{\partial t_*} &amp;= -fu_* - \alpha v_*, \label{v_mom_dim} \\
\frac{\partial w_*}{\partial t_*} &amp;= b_* - \frac{\partial \phi_*}{\partial z_*} - \alpha w_*, \label{w_mom_dim} \\
\frac{\partial b_*}{\partial t_*} + N^2 w_* &amp;= Q_* - \alpha b_*, \label{b_dim} \\
\frac{\partial u_*}{\partial x_*} + \frac{\partial w_*}{\partial z_*} &amp;= 0, \label{cont_dim} \\
w_*(z_*=0) &amp;= 0. \label{boundary_dim}
\end{align}\end{split}\]</div>
</div>
<p>The function <span class="math notranslate nohighlight">\(Q_*\)</span> represents a forcing on the buoyancy tendency we loosely call “heating”. <a class="reference external" href="https://doi.org/10.1175/1520-0469(1983)040&lt;1999:OTLTOT&gt;2.0.CO;2">Rotunno (1983)</a>, <a class="reference external" href="https://doi.org/10.1175/2008JAS2851.1">Qian et al. (2009)</a>, and many subsequent papers consider</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
Q_* = \frac{Q_0}{\pi}\left(\frac{\pi}{2}+\arctan\left(\frac{x_*}{L}\right)\right)\exp\left(-\frac{z_*}{H}\right)\cos(\omega t_*),
\label{Q_sea_breeze_dim}
\end{equation}\]</div>
<p>which emulates the heating/cooling of a land-surface <span class="math notranslate nohighlight">\(x&gt;0\)</span> as compared to an ocean surface <span class="math notranslate nohighlight">\(x&lt;0\)</span>, where <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(H\)</span> are horizontal and vertical length scales, respectively, and <span class="math notranslate nohighlight">\(\omega\)</span> is the diurnal frequency. The applet below visualizes this choice of <span class="math notranslate nohighlight">\(Q_*\)</span> <a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p id="igw-intro-applet"><strong>Rotunno (1983) Applet</strong></p>
<div id="land_sea_intro">
    <div id="loading-screen">
        <div class="spinner"></div>
        <p>Loading...</p>
        <p><small>This can take a few minutes!</small></p>
    </div>
    <div id="main-content">
        <div id="figure-output">
            <!-- Use two layers to prevent flickering in firefox -->
            <div id="land_sea_intro-figure-output-A" class="figure-layer is-active"></div>
            <div id="land_sea_intro-figure-output-B" class="figure-layer is-passive"></div>
        </div>
        <div id="controls"></div>
        <script>
            (function(containerID) {
                // Note containerID is set by utils.py
                
                const dimSliders = coreWaveSlidersDim(containerID);
                const nonDimSliders = coreWaveSlidersNonDim(containerID);
                
                // Add new sliders for L
                nonDimSliders.LSlider = getLNonDimSlider(containerID);
                dimSliders.LDimSlider = getLDimSlider(containerID);
                
                startingCoords = "dimensional";
                const coordToggle = createCoordinateSelectionRow(containerID, startingCoords);
                const overlayToggle = createOverlayToggleRow(containerID);
                // Note we switch off the quiver by default for the intro figure
                overlayToggle.querySelector(`#${containerID}-quiver-checkbox`).checked = false;
                // Note we change the default variable order for the intro figure to highlight Q
                const imshowSelection = createFieldSelectionRow(
                    containerID,
                    ["Q", "psi", "u", "v", "w"],
                    ["\\(Q\\)", "\\(\\psi\\)", "\\(u\\)", "\\(v\\)", "\\(w\\)"]
                );
                
                // Get the relevant div container
                container = document.querySelector(`#${containerID} #main-content #controls`);
                // Append all the control rows to the container
                container.append(coordToggle, overlayToggle, imshowSelection);
                container.append(...Object.values(nonDimSliders), ...Object.values(dimSliders));
                setupCoordinateToggle(containerID, startingCoords);
            })('land_sea_intro');
        </script>
        <py-script 
            src="/METOYBOX/_static/models/gravity_waves/land_sea_intro/land_sea_intro.py" 
            config="/METOYBOX/_static/assets/pyscript.toml"
            data-container-id="land_sea_intro">
        </py-script>
    </div>
</div><p>The idea is that we have chosen our coordinates <span class="math notranslate nohighlight">\((x_*, y_*, z_*)\)</span> so that <span class="math notranslate nohighlight">\(x_*=0\)</span>, <span class="math notranslate nohighlight">\(z_*=0\)</span> represents a coastline, which extends infinitely far into and out of the screen in the <span class="math notranslate nohighlight">\(y_*\)</span> direction. The <span class="math notranslate nohighlight">\(z_*=0\)</span> lower boundary represents land and sea for <span class="math notranslate nohighlight">\(x_*&gt;0\)</span> and <span class="math notranslate nohighlight">\(x_*&lt;0\)</span>, respectively; imagine you’re at the beach, looking down the coastline, with sand to your right, and water to your left. The land surface changes temperature over the course of the day, but the ocean surface temperature is comparatively constant. You should play with the <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(Q_0\)</span>, <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(L\)</span> sliders to see how the forcing <span class="math notranslate nohighlight">\(Q_*\)</span> changes. Also, with <span class="math notranslate nohighlight">\(Q_*\)</span> given by <span class="math notranslate nohighlight">\(\eqref{Q_sea_breeze_dim}\)</span> we can solve <span class="math notranslate nohighlight">\(\text{\eqref{u_mom_dim}-\eqref{boundary_dim}}\)</span> analytically! Switching on the quiver plot shows the <span class="math notranslate nohighlight">\((u, w)\)</span> vectors overlaid on <span class="math notranslate nohighlight">\(Q\)</span>. You can also change the shading from <span class="math notranslate nohighlight">\(Q\)</span> to another variable, e.g. <span class="math notranslate nohighlight">\(v\)</span>. If the applets are laggy in Firefox, abandon computer communism, and embrace Chrome counter-revolution instead.</p>
</section>
<section id="non-dimensionalization">
<span id="non-dim"></span><h2>Non-Dimensionalization<a class="headerlink" href="#non-dimensionalization" title="Link to this heading"></a></h2>
<p>Next we scale variables to remove units, i.e. we non-dimensionalize. One reason to non-dimensionalize is that units are mathematically annoying; what are the units of <span class="math notranslate nohighlight">\(\ln(10 \text{ m})\)</span>? Another reason to non-dimensionalize is to <a class="reference external" href="https://en.wikipedia.org/wiki/Buckingham_%CF%80_theorem">reduce the number of independent variables</a> in our models. Yet another reason is to ensure the interesting parts of our models are always visible in our figures as we mess with the parameters!</p>
<p>Here we use the scalings from <a class="reference external" href="https://doi.org/10.1175/2008JAS2851.1">Qian et al. (2009)</a>;</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\begin{split}
&amp;x_*=\frac{NH}{\omega}x, \quad y_*=\frac{NH}{\omega}y, \quad z_*=Hz,\quad t_*=\frac{t}{\omega}, \\
&amp;Q_*=Q_0Q,\quad u_*=\frac{Q_0}{N\omega}u, \quad v_*=\frac{Q_0}{N\omega}v, \quad w_* = \frac{Q_0}{N^2}w, \\
&amp;b_* = \frac{Q_0}{\omega} b,\quad \phi_*= \frac{Q_0H}{\omega}\phi,
\end{split}
\label{scalings}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is a representative height scale, <span class="math notranslate nohighlight">\(\omega\)</span> a representative frequency, and <span class="math notranslate nohighlight">\(Q_0\)</span> a representative amplitude of the forcing <span class="math notranslate nohighlight">\(Q\)</span>. These scales can often be inferred from the forcing function <span class="math notranslate nohighlight">\(Q\)</span>. Note with the land-sea breeze <span class="math notranslate nohighlight">\(Q\)</span> given above, <span class="math notranslate nohighlight">\(\omega=\frac{2\pi}{24\cdot 3600} \text{ s}^{-1}\approx 7.272 \times 10^{-5} \text{ s}^{-1}\)</span> is the diurnal frequency. In general however, <span class="math notranslate nohighlight">\(\omega\)</span> can be any representative frequency appropriate for the given problem.</p>
<p>Substituting the above scaling expressions into our governing equations and simplifying we get</p>
<div class="admonition-non-dimensional-governing-equations admonition">
<p class="admonition-title">Non-Dimensional Governing Equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_t &amp;= \frac{f}{\omega}v - p_x - \frac{\alpha}{\omega}u, \label{u_mom} \\
v_t &amp;= -\frac{f}{\omega}u - \frac{\alpha}{\omega}v, \label{v_mom} \\
\frac{\omega^2}{N^2}w_t &amp;= b - \phi_z - \frac{\omega^2}{N^2}\frac{\alpha}{\omega}w, \label{w_mom} \\
b_t + w &amp;= Q - \frac{\alpha}{\omega} b, \label{b} \\
u_x + w_z &amp;= 0, \label{cont} \\
w(z=0) &amp;= 0. \label{boundary}
\end{align}\end{split}\]</div>
</div>
<p>The <a class="reference external" href="https://doi.org/10.1175/1520-0469(1983)040&lt;1999:OTLTOT&gt;2.0.CO;2">Rotunno (1983)</a> <span class="math notranslate nohighlight">\(Q_*\)</span> function <span class="math notranslate nohighlight">\(\eqref{Q_sea_breeze_dim}\)</span> becomes</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
Q = \frac{1}{\pi}\left(\frac{\pi}{2}+\arctan\left(\frac{x}{\mathcal{L}}\right)\right)\exp\left(-z\right)\cos(t), \label{Q_sea_breeze}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{L} = \frac{\omega}{NH}L\)</span> is the non-dimensional horizontal length scale. <a class="footnote-reference brackets" href="#id6" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<p>Scroll back up to the <a class="reference internal" href="#igw-intro-applet"><span class="std std-ref">applet</span></a> (or open it in another window) and click the radio button to switch to non-dimensional coordinates. Notice the number of sliders decreases by two. As noted above, non-dimensionalization typically reduces the number of independent variables needed to completely describe all the possible behaviours of our model, reflecting a result called the <a href="https://en.wikipedia.org/wiki/Buckingham_%CF%80_theorem">Buckingham \(\pi\) Theorem</a>.</p>
</section>
<section id="hydrostatic-waves">
<h2>Hydrostatic Waves<a class="headerlink" href="#hydrostatic-waves" title="Link to this heading"></a></h2>
<p>When <span class="math notranslate nohighlight">\(\omega\)</span> is the diurnal frequency <span class="math notranslate nohighlight">\(\frac{2\pi}{24\cdot 3600} \text{ s}^{-1} \approx 7.272 \times 10^{-5} \text{ s}^{-1}\)</span>, the term <span class="math notranslate nohighlight">\(\frac{\omega^2}{N^2}\)</span> is tiny, and terms containing this factor can be neglected. Wave solutions for which <span class="math notranslate nohighlight">\(\frac{\omega^2}{N^2} \approx 0\)</span> are called hydrostatic waves. The adjective “hydrostatic” reflects</p>
<div class="math notranslate nohighlight">
\[\frac{\omega^2}{N^2} \approx 0 \Rightarrow b \approx \phi_z,\]</div>
<p>i.e. that buoyancy forces are approximately balanced by vertical pressure gradient forces. In this context the balance is only approximate, and hence does not imply <span class="math notranslate nohighlight">\(w=0\)</span>. Indeed, as we will see later, vertical velocities are essential to the core dynamics of gravity waves. The concept of “hydrostatic waves” is thus distinct from the usual “hydrostatic balance” condition <span class="math notranslate nohighlight">\(\frac{\partial p}{\partial z} = -\rho g\)</span> we encounter in synoptic meteorology, which does imply <span class="math notranslate nohighlight">\(w=0\)</span>.</p>
<p>In the land-sea breeze model above, <span class="math notranslate nohighlight">\(\omega\)</span> is indeed the diurnal frequency, and so the model is mostly unresponsive to <span class="math notranslate nohighlight">\(\frac{N}{\omega}\)</span>, except for the very smallest values of <span class="math notranslate nohighlight">\(N\)</span>. Switching back to dimensional coordinates, we see that varying <span class="math notranslate nohighlight">\(N\)</span> changes the tick labels on the <span class="math notranslate nohighlight">\(x\)</span> axis in accordance with the scalings given above.</p>
</section>
<section id="the-stream-function">
<h2>The Stream Function<a class="headerlink" href="#the-stream-function" title="Link to this heading"></a></h2>
<p>Most of our models are solved analytically using a stream function. By way of introduction, consider the function <span class="math notranslate nohighlight">\(\psi(x,z,t)\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[\psi(x,z,t) = \int_{z_0}^{z} u(x, z',t) \, dz' + f(x,t),\]</div>
<p>where <span class="math notranslate nohighlight">\(z_0\)</span> is some arbitrary constant starting height and <span class="math notranslate nohighlight">\(f(x)\)</span> is some function of <span class="math notranslate nohighlight">\(x\)</span> alone. Provided <span class="math notranslate nohighlight">\(u\)</span> is continuous for <span class="math notranslate nohighlight">\(z'\in [z_0,z]\)</span>, the <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_calculus#First_part">first part of the fundamental theorem of calculus</a> implies <span class="math notranslate nohighlight">\(\psi_z = u\)</span>. Now</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\psi_x &amp;= \frac{\partial}{\partial x} \left(\int_{z_0}^{z} u(x, z',t) \, dz' + f(x,t)\right) \\
&amp;= \int_{z_0}^{z} u_x(x, z',t) \, dz' + f_x(x,t),
\end{align}\end{split}\]</div>
<p>where the second line follows from the <a class="reference external" href="https://en.wikipedia.org/wiki/Leibniz_integral_rule">Leibniz integral rule</a>, noting neither <span class="math notranslate nohighlight">\(z_0\)</span> or <span class="math notranslate nohighlight">\(z\)</span> depend on <span class="math notranslate nohighlight">\(x\)</span>. But the continuity equation for our Boussinesq fluid implies <span class="math notranslate nohighlight">\(u_x = -w_z\)</span>, and so</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\psi_x &amp;=  \int_{z_0}^{z} -w_z(x, z',t) \, dz' + f_x(x,t) \\
&amp;= -w(x,z,t) + w(x,z_0,t) + f_x(x,t),
\end{align}\end{split}\]</div>
<p>where the second line follows from the <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_calculus#Second_part">second part of the fundamental theorem of calculus</a>, which holds provided <span class="math notranslate nohighlight">\(w(x,z',t)\)</span> is continuous for <span class="math notranslate nohighlight">\(z\in [z_0,z]\)</span>. Now, so far <span class="math notranslate nohighlight">\(f(x,t)\)</span> has been arbitrary, but let’s impose the additional condition that <span class="math notranslate nohighlight">\(f_x(x,t):= -w(x,z_0,t)\)</span>. Then <span class="math notranslate nohighlight">\(w=-\psi_x\)</span>.</p>
<p>We have therefore found a scalar function <span class="math notranslate nohighlight">\(\psi(x,z,t)\)</span>, which we call a stream function, which satisfies</p>
<div class="admonition-core-property-of-stream-functions admonition">
<p class="admonition-title">Core Property of Stream Functions</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
(u,w) = (\psi_z, -\psi_x).
\end{equation}\]</div>
</div>
<p>Stream functions simplify things considerably. It’s easier to solve for one scalar field <span class="math notranslate nohighlight">\(\psi\)</span> than a vector field <span class="math notranslate nohighlight">\((u,w)\)</span>. Stream functions are also physically interpretable. In our case the <span class="math notranslate nohighlight">\((u,w)\)</span> winds are tangential to the contours of <span class="math notranslate nohighlight">\(\psi\)</span> at all times, and the more closely packed the contours, the stronger the winds. Note that this does not imply parcel trajectories follow streamlines! You can study the relationship between <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\((u,w)\)</span> using the <a class="reference internal" href="#igw-intro-applet"><span class="std std-ref">applet</span></a> by switching the shading to <span class="math notranslate nohighlight">\(\psi\)</span> and turning on the quiver plot.</p>
<p>Note stream functions are in general not unique; we can add any function <span class="math notranslate nohighlight">\(g(t)\)</span> of <span class="math notranslate nohighlight">\(t\)</span> alone to <span class="math notranslate nohighlight">\(f(x,t)\)</span> and still have <span class="math notranslate nohighlight">\(f_x(x,t):= -w(x,z_0,t)\)</span> and <span class="math notranslate nohighlight">\((u,w) = (\psi_z, -\psi_x)\)</span>.</p>
<p>The preceding argument shows stream functions exist provided <span class="math notranslate nohighlight">\(u_x + w_z = 0\)</span>, and continuity conditions on <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(w\)</span> are satisfied. This is a special case of the <a class="reference external" href="https://en.wikipedia.org/wiki/Poincar%C3%A9_lemma">Poincaré lemma</a>, typically taught in graduate <a class="reference external" href="https://en.wikipedia.org/wiki/Differential_geometry">differential geometry</a> courses. <a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
</section>
<section id="a-partial-differential-equation">
<h2>A Partial Differential Equation<a class="headerlink" href="#a-partial-differential-equation" title="Link to this heading"></a></h2>
<p>We now derive a single partial differential equation (PDE) for the stream function <span class="math notranslate nohighlight">\(\psi\)</span>. We’ll include some algebraic gore as it’s our first time. To start, rewrite <span class="math notranslate nohighlight">\(\text{\eqref{u_mom}-\eqref{b}}\)</span> by grouping the time tendency and diffusion terms; equations <span class="math notranslate nohighlight">\(\eqref{u_mom}\)</span> and <span class="math notranslate nohighlight">\(\eqref{v_mom}\)</span> become</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)u &amp;= \frac{f}{\omega}v-\phi_x, \label{u_mom_grouped} \\
\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)v &amp;= -\frac{f}{\omega}u. \label{v_mom_grouped}
\end{align}\end{split}\]</div>
<p>If expressions like <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\)</span> disturb you, you’re not alone! Have a look at :ref:``   Take <span class="math notranslate nohighlight">\(\left(\frac{\partial }{\partial t} + \frac{\alpha}{\omega}\right)\)</span> of <span class="math notranslate nohighlight">\(\eqref{u_mom_grouped}\)</span> and substitute in <span class="math notranslate nohighlight">\(\eqref{v_mom_grouped}\)</span> to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)^2 u = -\frac{f^2}{\omega^2}u - \left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)\phi_x.
\label{u_mom_alt}
\end{equation}\]</div>
<p>Then take <span class="math notranslate nohighlight">\(\frac{\partial}{\partial z}\)</span> of both sides of <span class="math notranslate nohighlight">\(\eqref{u_mom_alt}\)</span> to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)^2 u_z = -\frac{f^2}{\omega^2}u_z - \left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)\phi_{xz}.
\label{u_mom_alt_z}
\end{equation}\]</div>
<p>Next, rearrange <span class="math notranslate nohighlight">\(\eqref{w_mom}\)</span> and take <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\frac{\partial}{\partial x}\)</span> of both sides to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\frac{\omega^2}{N^2}\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)^2 w_x = \left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)b_x - \left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\phi_{zx}.\label{w_mom_alt_x}
\end{equation}\]</div>
<p>Now use <span class="math notranslate nohighlight">\(\eqref{w_mom_alt_x}\)</span> to eliminate <span class="math notranslate nohighlight">\(-\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\phi_{zx}\)</span> in <span class="math notranslate nohighlight">\(\eqref{u_mom_alt_z}\)</span> to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)^2 u_z + \frac{f^2}{\omega^2}u_z = \frac{\omega^2}{N^2}\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)^2 w_x - \left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)b_x.
\label{u_w}
\end{equation}\]</div>
<p>Next, rearrange <span class="math notranslate nohighlight">\(\eqref{b}\)</span> and take an <span class="math notranslate nohighlight">\(x\)</span> derivative of both sides to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
-\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)b_x = -Q_x + w_x \label{b_x}.
\end{equation}\]</div>
<p>Now substitute <span class="math notranslate nohighlight">\(\eqref{b_x}\)</span> into <span class="math notranslate nohighlight">\(\eqref{u_w}\)</span> and rearrange to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)^2 u_z + \frac{f^2}{\omega^2}u_z - \frac{\omega^2}{N^2}\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)^2 w_x - w_x = -Q_x.
\label{u_w_alt}
\end{equation}\]</div>
<p>Finally, substitute <span class="math notranslate nohighlight">\((u_z,w_x) = (\psi_{zz}, -\psi_{xx})\)</span> into <span class="math notranslate nohighlight">\(\eqref{u_w_alt}\)</span> and group terms to get</p>
<div class="admonition-partial-differential-equation-for-math-psi admonition">
<p class="admonition-title">Partial Differential Equation for <span class="math notranslate nohighlight">\(\psi\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\left[\left(\frac{\partial}{\partial t}+\frac{\alpha}{\omega}\right)^2 + \frac{f^2}{\omega^2} \right] \psi_{zz} + \left[\frac{\omega^2}{N^2}\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)^2 + 1\right] \psi_{xx}  = -Q_x.
\label{psi_pde}
\end{equation}\]</div>
</div>
</section>
<section id="the-fourier-transform">
<h2>The Fourier Transform<a class="headerlink" href="#the-fourier-transform" title="Link to this heading"></a></h2>
<p>The next step is to take <a class="reference external" href="https://en.wikipedia.org/wiki/Fourier_transform">Fourier transforms</a> <span class="math notranslate nohighlight">\(t\mapsto \sigma\)</span> and <span class="math notranslate nohighlight">\(x\mapsto k\)</span> of <span class="math notranslate nohighlight">\(\eqref{psi_pde}\)</span> to get</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\left[\left(i\sigma+\frac{\alpha}{\omega}\right)^2 + \frac{f^2}{\omega^2} \right] \widehat{\psi}_{zz} - k^2 \left[\frac{\omega^2}{N^2}\left(i\sigma + \frac{\alpha}{\omega}\right)^2 + 1\right] \widehat{\psi}  = -\widehat{Q_x}.
\label{psi_fourier}
\end{equation}\]</div>
<p>Now define for convenience</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\widehat{\sigma} &amp;= i\sigma + \frac{\alpha}{\omega}, \\
B &amp;= \sqrt{-\widehat{\sigma}^2-\frac{f^2}{\omega^2}}, \\
C &amp;= \sqrt{\frac{\omega^2}{N^2}\widehat{\sigma}^2 + 1}, \\
A &amp;= B/C.
\end{align}\end{split}\]</div>
<p>Then <span class="math notranslate nohighlight">\(\eqref{psi_fourier}\)</span> can be expressed</p>
<div class="admonition-ordinary-differential-equation-for-math-widehat-psi admonition">
<p class="admonition-title">Ordinary Differential Equation for <span class="math notranslate nohighlight">\(\widehat{\psi}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\widehat{\psi}_{zz} + \frac{k^2}{A^2} \widehat{\psi}  = \frac{1}{B^2}\widehat{Q_x}.
\label{psi_fourier_simp}
\end{equation}\]</div>
</div>
<p>To better understand equation <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span>, let’s review what we’ve done so far.</p>
<ol class="arabic simple">
<li><p>We started with equations <span class="math notranslate nohighlight">\(\eqref{u_mom_dim}-\eqref{boundary_dim}\)</span>, a system of coupled PDEs enforcing conservation of momentum, energy and mass for our fluid.</p></li>
<li><p>We non-dimensionalized and crunched these PDEs down into a single equation for the stream function <span class="math notranslate nohighlight">\(\psi\)</span> to get <span class="math notranslate nohighlight">\(\eqref{psi_pde}\)</span>.</p></li>
<li><p>Taking Fourier transforms in <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(x\)</span> has now given us <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span>, an ordinary differential equation (ODE) in <span class="math notranslate nohighlight">\(z\)</span> for <span class="math notranslate nohighlight">\(\widehat{\psi}\)</span>.</p></li>
</ol>
<p>Note the function <span class="math notranslate nohighlight">\(\widehat{\psi}\)</span> depends on <span class="math notranslate nohighlight">\(k, z\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>, and remember that the inverse Fourier transform says</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\psi(x,z,t) = \frac{1}{4\pi^2} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \widehat{\psi}(k,z,\sigma) e^{i(kx + \sigma t)} \, dk \, d\sigma.
\label{inverse_fourier}
\end{equation}\]</div>
<p>So really what we’ve done is express <span class="math notranslate nohighlight">\(\psi\)</span> as a fancy sum (a double integral) of wave like terms <span class="math notranslate nohighlight">\(\widehat{\psi}(k,z,\sigma) e^{i(kx + \sigma t)}\)</span>, with the amplitudes of these waves given by <span class="math notranslate nohighlight">\(\widehat{\psi}(k,z,\sigma)\)</span>. We can therefore describe <span class="math notranslate nohighlight">\(\widehat{\psi}\)</span> as a “vertical structure function”. Analogous points apply to <span class="math notranslate nohighlight">\(\widehat{Q_x}\)</span>, which gives us the vertical structure of the forcing decomposed into its constituent horizontal wavenumbers and frequencies.</p>
<p>Equation <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span> thus tells us how the vertical structure of the response depends on the vertical structure of the forcing. In other words, we can think of <span class="math notranslate nohighlight">\(Q\)</span> as having “excited” a bunch of different horizontal waves <span class="math notranslate nohighlight">\(e^{i(kx + \sigma t)}\)</span> in our fluid, with the strength of each wave at height <span class="math notranslate nohighlight">\(z\)</span> determined precisely from <span class="math notranslate nohighlight">\(Q\)</span> via <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span>.</p>
</section>
<section id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Link to this heading"></a></h2>
<p>So to solve the Rotunno (1983) model, we just need to solve <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span> for <span class="math notranslate nohighlight">\(\widehat{\psi}\)</span>, then recover <span class="math notranslate nohighlight">\(\psi\)</span> via the inverse Fourier transform <span class="math notranslate nohighlight">\(\eqref{inverse_fourier}\)</span>. Our first step is to consider the simpler, so called “homogeneous”, version of <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span>,</p>
<div class="admonition-homogenous-equation-for-math-widehat-psi admonition">
<p class="admonition-title">Homogenous Equation for <span class="math notranslate nohighlight">\(\widehat{\psi}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\widehat{\psi}_{zz} + \frac{k^2}{A^2} \widehat{\psi} = 0,
\label{psi_homo}
\end{equation}\]</div>
</div>
<p>i.e. <span class="math notranslate nohighlight">\(\eqref{psi_fourier_simp}\)</span> but with <span class="math notranslate nohighlight">\(\widehat{Q_x}=0\)</span>. Writing <span class="math notranslate nohighlight">\(m=\frac{k}{A}\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\widehat{\psi} = a_p e^{imz} + a_m e^{-imz},
\label{homo_sol}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_p, a_m \in\mathbb{C}\)</span> do not depend on <span class="math notranslate nohighlight">\(z\)</span>. Notice that we have yet to apply the lower boundary condition <span class="math notranslate nohighlight">\(\eqref{boundary}\)</span>. Indeed, if there were no lower boundary, and if <span class="math notranslate nohighlight">\(Q=0\)</span>, then <span class="math notranslate nohighlight">\(\eqref{homo_sol}\)</span> and <span class="math notranslate nohighlight">\(\eqref{inverse_fourier}\)</span> suggest that all expressions of the form</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\psi = a_p e^{i(kx + mz + \sigma t)} + a_m e^{i(kx - mz + \sigma t)},
\label{Eq:basic_sol}
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(m = \frac{k}{A}\)</span>, are solutions to our system <span class="math notranslate nohighlight">\(\eqref{u_mom} - \eqref{cont}\)</span>; you can check this by direct substitution. Note in the case of no dispersion, <span class="math notranslate nohighlight">\(\alpha=0\)</span>, the condition <span class="math notranslate nohighlight">\(m = \frac{k}{A}\)</span> is equivalent to the usual intertia-gravity wave dispersion relation, stated in dimensional coordinates,</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\frac{k_*^2}{m_*^2} = \frac{\sigma_*^2 - f^2}{N^2-\sigma_*^2},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(k_*, m_*, \sigma_*\)</span> are the wavenumbers and frequency in dimensional coordinates. <a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a></p>
<p><strong>Plane Wave</strong></p>
<div id="plane_wave">
    <div id="loading-screen">
        <div class="spinner"></div>
        <p>Loading...</p>
        <p><small>This can take a few minutes!</small></p>
    </div>
    <div id="main-content">
        <div id="figure-output">
            <!-- Use two layers to prevent flickering in firefox -->
            <div id="plane_wave-figure-output-A" class="figure-layer is-active"></div>
            <div id="plane_wave-figure-output-B" class="figure-layer is-passive"></div>
        </div>
        <div id="controls"></div>
        <script>
            (function(containerID) {
                // Note containerID is set by utils.py
                
                const dimSliders = coreWaveSlidersDim(containerID);
                delete dimSliders.Q0Slider;
                const nonDimSliders = coreWaveSlidersNonDim(containerID);
                
                // Allow alpha to be zero for these models (also initialize to zero)
                nonDimSliders.alphaOmegaSlider.querySelector("input").min = 0;
                dimSliders.alphaSlider.querySelector("input").min = 0;
                nonDimSliders.alphaOmegaSlider.querySelector("input").value = 0;
                dimSliders.alphaSlider.querySelector("input").value = 0;
                
                // Add sliders for k and sigma
                nonDimSliders.kNonDimSlider = getKNonDimSlider(containerID);
                dimSliders.kDimSlider = getKDimSlider(containerID);
                
                nonDimSliders.sigmaNonDimSlider = getSigmaNonDimSlider(containerID);
                dimSliders.sigmaDimSlider = getSigmaDimSlider(containerID);
                
                const startingCoords = "dimensional";
                const coordToggle = createCoordinateSelectionRow(containerID, startingCoords);
                const overlayToggle = createOverlayToggleRow(containerID);
                overlayToggle.querySelector(
                    `#${containerID}-displacement-checkbox`
                ).checked = true;
                
                const imshowSelection = createFieldSelectionRow(
                    containerID,
                    ["psi", "u", "v", "w", "phi"],
                    ["\\(\\psi\\)", "\\(u\\)", "\\(v\\)", "\\(w\\)", "\\(\\phi\\)"]
                );
                const quiverSelection = createFieldSelectionRow(
                    containerID,
                    ["velocity", "grad_phi", "buoyancy", "coriolis", "acceleration"],
                    [
                        "\\( \\mathbf{u} \\)",
                        "\\( - \\nabla \\phi \\)",
                        "\\(b\\mathbf{k} \\)",
                        "\\( fv \\mathbf{i} \\)",
                        "\\( \\mathbf{a} \\)",
                    ],
                    "quiver",
                    [
                        "\\( \\mathbf{u} \\)",
                        "\\( - \\nabla \\phi \\)",
                        "\\(b\\mathbf{k} \\)",
                        "\\( \\frac{f}{\\omega} v \\mathbf{i} \\)",
                        "\\( \\mathbf{a} \\)",
                    ]
                );
                
                // Get the relevant div container
                container = document.querySelector(`#${containerID} #main-content #controls`);
                // Append all the control rows to the container
                container.append(coordToggle, overlayToggle, imshowSelection, quiverSelection);
                container.append(...Object.values(nonDimSliders), ...Object.values(dimSliders));
                setupCoordinateToggle(containerID, startingCoords);
            })('plane_wave');
        </script>
        <py-script 
            src="/METOYBOX/_static/models/gravity_waves/plane_wave/plane_wave.py" 
            config="/METOYBOX/_static/assets/pyscript.toml"
            data-container-id="plane_wave">
        </py-script>
    </div>
</div></section>
<section id="appendix-a-operators">
<h2>Appendix A: Operators<a class="headerlink" href="#appendix-a-operators" title="Link to this heading"></a></h2>
<p>To get equation <span class="math notranslate nohighlight">\(\eqref{u_mom_grouped}\)</span>, we implicitly used the fact that</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\frac{\partial u}{\partial t} + \frac{\alpha}{\omega}u = \left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)u. \label{grouped_terms}
\end{equation}\]</div>
<p>Equations like <span class="math notranslate nohighlight">\(\eqref{grouped_terms}\)</span> freaked me out when I first encountered them. For numbers <span class="math notranslate nohighlight">\(a, b, c\)</span> we know multiplication distributes over addition, i.e. <span class="math notranslate nohighlight">\(ac + bc = (a+b)c\)</span>, and equation <span class="math notranslate nohighlight">\(\eqref{grouped_terms}\)</span> may therefore feel intuitive. However, <span class="math notranslate nohighlight">\(\frac{\partial u}{\partial t}, u\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}\)</span> are functions, not numbers! Even worse, <span class="math notranslate nohighlight">\(\frac{\partial u}{\partial t}\)</span> and <span class="math notranslate nohighlight">\(u\)</span> are functions mapping real vectors to real numbers, but <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}\)</span> is a function mapping one function to another function, e.g. <span class="math notranslate nohighlight">\(u \mapsto \frac{\partial u}{\partial t}\)</span>. So the distributive law for numbers isn’t actually relevant here.</p>
<p>To make sense of equations like <span class="math notranslate nohighlight">\(\eqref{grouped_terms}\)</span>, note that they express equalities of functions, not numbers; the same is true of most other equations on this page. Two functions are equal if their domains and co-domains are the same, and they map the same points in the domain to the same points in the co-domain. Furthermore, the additions and multiplications you see in equations like <span class="math notranslate nohighlight">\(\eqref{grouped_terms}\)</span> actually express addition of functions, and multiplication of functions by numbers. For arbitrary functions <span class="math notranslate nohighlight">\(f:A\to B\)</span> and <span class="math notranslate nohighlight">\(g:A\to B\)</span>, we define <span class="math notranslate nohighlight">\(f+g:A\to B\)</span> as the new function <span class="math notranslate nohighlight">\((f+g):A\to B\)</span> satisfying <span class="math notranslate nohighlight">\((f+g)(x) = f(x) + g(x)\)</span> for all <span class="math notranslate nohighlight">\(x\in A\)</span>. In an analogous way, for a number <span class="math notranslate nohighlight">\(a\)</span>, we define <span class="math notranslate nohighlight">\((af)(x) = af(x)\)</span>. You’re probably used to doing all this without even thinking about it!</p>
<p>Things get confusing with expressions like <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\)</span>. As noted above, <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}\)</span> is really a function which acts on functions; such objects are typically called <a class="reference external" href="https://en.wikipedia.org/wiki/Operator_(mathematics)">operators</a>. Analogously to above, we can define what it means to sum two operators, and multiply an operator by a function. Thus the expression <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\)</span> is really a sum of two operators, where we must interpret <span class="math notranslate nohighlight">\(\frac{\alpha}{\omega}\)</span> as the operator which sends a function, say <span class="math notranslate nohighlight">\(u\)</span>, to the function <span class="math notranslate nohighlight">\(\frac{\alpha}{\omega}u\)</span>. Using square brackets to enclose the function being fed into the given operator, we thus have</p>
<div class="math notranslate nohighlight">
\[\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\left[u\right] = \frac{\partial}{\partial t}[u] + \frac{\alpha}{\omega}[u],\]</div>
<p>by definition. In practice you will rarely see operators written out this way; typically we just assume operators “act from the left”, i.e.</p>
<div class="math notranslate nohighlight">
\[\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\left[u\right] = \frac{\partial}{\partial t}[u] + \frac{\alpha}{\omega}[u]\]</div>
<p>means the same thing as</p>
<div class="math notranslate nohighlight">
\[\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)u = \frac{\partial u}{\partial t} + \frac{\alpha}{\omega}u.\]</div>
<p>However, suppressing the square brackets can be deceptive, as it may appear we are  “multiplying” terms like <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\)</span> and <span class="math notranslate nohighlight">\(u\)</span>, rather than feeding <span class="math notranslate nohighlight">\(u\)</span> into the operator <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\)</span>. Sometimes we really are multiplying though, in the sense of multiplying an operator by a function. For instance, you may see expressions like <span class="math notranslate nohighlight">\(u\frac{\partial}{\partial t}\)</span>, which multiplies the function <span class="math notranslate nohighlight">\(u\)</span> by the operator <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}\)</span> to produce another operator; this operator is thus a completely different mathematical object to <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}u\)</span>, which is a function! Similarly, you may see expressions like <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)^2\)</span>, which should be interpreted as a composition of operators, i.e. <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\circ \left(\frac{\partial}{\partial t} + \frac{\alpha}{\omega}\right)\)</span>.</p>
<p>The ideas sketched in this appendix are made rigorous in <a class="reference external" href="https://en.wikipedia.org/wiki/Abstract_algebra">abstract algebra</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Functional_analysis">functional analysis</a> courses.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>In our applets we omit the <span class="math notranslate nohighlight">\(*\)</span> subscripts, as the choice of dimensional or non-dimensional variables is clear from the radio button.</p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>In our applets we write the horizontal length scale simply as <span class="math notranslate nohighlight">\(L\)</span> for both dimensional and non-dimensional coordinates, as javascript struggles with calligraphic math symbols, and the meaning of <span class="math notranslate nohighlight">\(L\)</span> is clear from the context.</p>
</aside>
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://doi.org/10.1017/CBO9780511800955">Batchelor’s (1967, p. 76)</a> discussion of stream functions uses the language of exact and closed <a class="reference external" href="https://en.wikipedia.org/wiki/Differential_form">differential forms</a>, ideas from <a class="reference external" href="https://en.wikipedia.org/wiki/Differential_geometry">differential geometry</a>, and Batchelor appears to implicitly invoke the Poincaré lemma in his argument; I don’t like this approach, as it invokes graduate level maths unnecessarily. You may have also encountered differential forms in thermodynamics, where they add an almost catastrophic level of confusion. See Bohrens &amp; Albrecht (2023) for a scathing critique of differential forms in thermodynamics, with which I agree!</p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>To get <span class="math notranslate nohighlight">\(k_*\)</span>, note <span class="math notranslate nohighlight">\(k=\frac{2\pi}{\lambda_x}\)</span> where <span class="math notranslate nohighlight">\(\lambda_x\)</span> is the horizontal wavelength in non-dimensional coordinates. Converting back to dimensional coordinates we have <span class="math notranslate nohighlight">\(\lambda_x^* = \frac{NH}{\omega}\lambda_x\)</span> and so <span class="math notranslate nohighlight">\(k_* = \frac{\omega}{NH}k\)</span>. The dimensional vertical wavenumber <span class="math notranslate nohighlight">\(m_*\)</span> and frequency <span class="math notranslate nohighlight">\(\sigma_*\)</span> are obtained analogously.</p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Inertia-Gravity Waves" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="land_sea.html" class="btn btn-neutral float-right" title="Land-Sea Breeze" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Ewan Short.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>